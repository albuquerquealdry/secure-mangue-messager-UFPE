{% extends "base.html" %}
{% block content %}
    <h1>ü¶Ä Sobre o Secure Mangue Messenger</h1>
    
    <div class="sobre-content">
        <p>O Secure Mangue Messenger √© um projeto de prova de conceito que implementa um sistema de mensagens E2EE (End-to-End Encrypted) com garantias robustas de seguran√ßa, inspirado na filosofia "Da Lama ao Caos" de conectar ra√≠zes tradicionais (criptografia cl√°ssica) com a vanguarda tecnol√≥gica (algoritmos modernos).</p>
        
        <p>Nosso objetivo √© garantir os 4 pilares da seguran√ßa da informa√ß√£o em cada troca de mensagem:</p>
        <ul>
            <li><strong>Confidencialidade:</strong> Ningu√©m no meio do caminho (nem mesmo o servidor) pode ler o conte√∫do da sua mensagem.</li>
            <li><strong>Autenticidade:</strong> Voc√™ tem certeza de quem enviou a mensagem.</li>
            <li><strong>Integridade:</strong> Voc√™ tem certeza de que a mensagem n√£o foi alterada no caminho.</li>
            <li><strong>N√£o Rep√∫dio:</strong> O remetente n√£o pode negar que enviou a mensagem.</li>
        </ul>

        <hr style="border-color: #555;">

        <h2>A Jornada T√©cnica: O Envio de uma Mensagem</h2>
        <p>Quando "Chico" envia uma mensagem para "Peixe", n√£o √© uma simples string. √â um pacote criptogr√°fico complexo. Veja o que acontece nos bastidores:</p>

        <h3>1. Criptografia H√≠brida (Confidencialidade)</h3>
        <p>N√£o podemos cifrar a mensagem inteira com RSA, pois √© muito lento. Usamos uma abordagem h√≠brida:</p>
        <ol>
            <li><strong>Cifragem Sim√©trica (AES-GCM):</strong> O sistema gera uma chave sim√©trica de uso √∫nico (uma chave AES-256). A mensagem de Chico √© cifrada com esta chave. O modo <strong>GCM (Galois/Counter Mode)</strong> √© usado por ser um modo AEAD, que j√° nos d√° integridade do ciphertext (a "Tag de Autentica√ß√£o").</li>
            <li><strong>Cifragem Assim√©trica (RSA-OAEP):</strong> Agora, como enviar essa chave AES para "Peixe" de forma segura? O sistema pega a <strong>Chave P√∫blica</strong> de "Peixe" (que est√° no nosso "Armaz√©m de Confian√ßa") e a usa para cifrar ("embrulhar" ou "wrap") a chave AES.</li>
        </ol>
        <p>O resultado √© um pacote com `(ciphertext, nonce)` (do AES) e uma `wrapped_aes_key` (do RSA).</p>

        <h3>2. Assinatura Digital (Autenticidade e Integridade)</h3>
        <p>Como "Peixe" sabe que foi "Chico" quem enviou, e que a mensagem n√£o foi adulterada?</p>
        <ol>
            <li><strong>Hashing (BLAKE2b):</strong> Primeiro, o sistema calcula um hash criptogr√°fico (uma "impress√£o digital") da mensagem original de "Chico" usando <strong>BLAKE2b</strong>, um algoritmo extremamente r√°pido e mais seguro que o SHA-2.</li>
            <li><strong>Manifesto:</strong> O sistema cria um "manifesto" √∫nico: `timestamp + sender + recipient + hash_blake2b`.</li>
            <li><strong>Assinatura (RSA-PSS):</strong> O sistema ent√£o usa a <strong>Chave Privada</strong> de "Chico" (que ele provou ter ao fazer login) para assinar digitalmente esse manifesto. Usamos o padding <strong>PSS</strong>, que √© o padr√£o moderno e mais seguro para assinaturas RSA.</li>
        </ol>

        <h3>3. Verifica√ß√£o (O Recebimento)</h3>
        <p>Quando "Peixe" l√™ a mensagem, ele faz o processo inverso em 7 camadas de seguran√ßa:</p>
        <ol>
            <li><strong>Busca Segura:</strong> O sistema s√≥ busca a mensagem se ela for destinada a "Peixe".</li>
            <li><strong>Anti-Replay:</strong> O sistema verifica se essa mensagem j√° foi lida antes (via cache) e se o timestamp √© recente.</li>
            <li><strong>Verifica√ß√£o de Chave:</strong> O sistema carrega a <strong>Chave P√∫blica Confi√°vel</strong> de "Chico" (verificando seu hash no `trust_store.json`) para se proteger contra MITM.</li>
            <li><strong>Verifica√ß√£o de Assinatura:</strong> A assinatura √© verificada com a Chave P√∫blica de "Chico". Se falhar, a mensagem √© <strong>rejeitada</strong>. (Autenticidade OK).</li>
            <li><strong>Desembrulhar Chave:</strong> "Peixe" usa sua pr√≥pria <strong>Chave Privada</strong> (da sua senha de login) para decifrar a `wrapped_aes_key` e obter a chave AES. (Confidencialidade OK).</li>
            <li><strong>Decifrar (AES-GCM):</strong> A chave AES recuperada √© usada para decifrar a mensagem. A "Tag de Autentica√ß√£o" do GCM √© verificada. Se falhar, o ciphertext foi adulterado, e a mensagem √© <strong>rejeitada</strong>.</li>
            <li><strong>Verifica√ß√£o de Hash:</strong> O sistema calcula o hash BLAKE2b da mensagem decifrada e compara com o hash que veio no manifesto assinado. Se n√£o baterem, a mensagem √© <strong>rejeitada</strong>. (Integridade OK).</li>
        </ol>
        <p>Somente se a mensagem passar por <strong>TODAS</strong> as 7 verifica√ß√µes, ela √© exibida para "Peixe".</p>

        <h3>4. Auditoria Assinada (Seguran√ßa do Sistema)</h3>
        <p>Cada uma dessas a√ß√µes (login, falha de login, envio, leitura, falha de verifica√ß√£o) √© registrada em um `audit.log`. Para provar que o pr√≥prio log n√£o foi adulterado, o sistema (usando a chave privada do usu√°rio `audit`) assina digitalmente o arquivo de log a cada novo evento, criando um `audit.log.sig`.</p>
    </div>
{% endblock %}